<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 7 Bootstrap paramétrico | Fundamentos de Estadística con Remuestreo</title>
  <meta name="description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2022." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 7 Bootstrap paramétrico | Fundamentos de Estadística con Remuestreo" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2022." />
  <meta name="github-repo" content="tereom/fundamentos-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 7 Bootstrap paramétrico | Fundamentos de Estadística con Remuestreo" />
  
  <meta name="twitter:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2022." />
  

<meta name="author" content="Teresa Ortiz, Alfredo Garbuno, Felipe González" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimación-por-máxima-verosimilitud.html"/>
<link rel="next" href="apéndice-principios-de-visualizacion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" 
integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous">
  </script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/fnaufel/smartify/smartify.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentos de Estadística con Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html"><i class="fa fa-check"></i>Temario</a>
<ul>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#plan-semanal"><i class="fa fa-check"></i>Plan semanal</a></li>
<li class="chapter" data-level="" data-path="temario.html"><a href="temario.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html"><i class="fa fa-check"></i><b>1</b> Análisis exploratorio</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#el-papel-de-la-exploración-en-el-análisis-de-datos"><i class="fa fa-check"></i>El papel de la exploración en el análisis de datos</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#preguntas-y-datos"><i class="fa fa-check"></i>Preguntas y datos</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#algunos-conceptos-básicos"><i class="fa fa-check"></i>Algunos conceptos básicos</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#histogramas"><i class="fa fa-check"></i>Histogramas</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#media-y-desviación-estándar"><i class="fa fa-check"></i>Media y desviación estándar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#precios-de-casas"><i class="fa fa-check"></i>Precios de casas</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#prueba-enlace"><i class="fa fa-check"></i>Prueba Enlace</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#estados-y-calificaciones-en-sat"><i class="fa fa-check"></i>Estados y calificaciones en SAT</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#tablas-de-conteos"><i class="fa fa-check"></i>Tablas de conteos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#suavizamiento-loess"><i class="fa fa-check"></i>Suavizamiento loess</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#opcional-cálculo-del-suavizador"><i class="fa fa-check"></i>Opcional: cálculo del suavizador</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#caso-de-estudio-nacimientos-en-méxico"><i class="fa fa-check"></i>Caso de estudio: nacimientos en México</a>
<ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#datos-de-natalidad-para-méxico"><i class="fa fa-check"></i>Datos de natalidad para México</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#tendencia"><i class="fa fa-check"></i>Tendencia</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#componente-anual"><i class="fa fa-check"></i>Componente anual</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#día-de-la-semana"><i class="fa fa-check"></i>Día de la semana</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#residuales"><i class="fa fa-check"></i>Residuales</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#reestimación"><i class="fa fa-check"></i>Reestimación</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#análisis-de-componentes"><i class="fa fa-check"></i>Análisis de componentes</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#residuales-antes-y-después-de-2006"><i class="fa fa-check"></i>Residuales: antes y después de 2006</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#otros-días-especiales-más-de-residuales"><i class="fa fa-check"></i>Otros días especiales: más de residuales</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#semana-santa"><i class="fa fa-check"></i>Semana santa</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html"><i class="fa fa-check"></i><b>2</b> Tipos de estudio y experimentos</a>
<ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#motivación"><i class="fa fa-check"></i>Motivación</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#proceso-generador-de-datos"><i class="fa fa-check"></i>Proceso Generador de Datos</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-prevalencia-de-anemia"><i class="fa fa-check"></i>Ejemplo: Prevalencia de anemia</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#muestreo-aleatorio"><i class="fa fa-check"></i>Muestreo aleatorio</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#pero-si-no-podemos-hacer-muestreo-aleatorio"><i class="fa fa-check"></i>Pero si no podemos hacer muestreo aleatorio?</a>
<ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-policías-y-tráfico"><i class="fa fa-check"></i>Ejemplo: Policías y tráfico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#el-estimador-estándar"><i class="fa fa-check"></i>El estimador estándar</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#experimentos-tradicionales"><i class="fa fa-check"></i>Experimentos tradicionales</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#bloqueo"><i class="fa fa-check"></i>Bloqueo</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#variables-desconocidas"><i class="fa fa-check"></i>Variables desconocidas</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#aleatorizando-el-tratamiento"><i class="fa fa-check"></i>Aleatorizando el tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#selección-de-unidades-y-tratamiento"><i class="fa fa-check"></i>Selección de unidades y tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#asignación-natural-del-tratamiento"><i class="fa fa-check"></i>Asignación natural del tratamiento</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>3</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparación-con-poblaciones-de-referencia"><i class="fa fa-check"></i>Comparación con poblaciones de referencia</a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparando-distribuciones"><i class="fa fa-check"></i>Comparando distribuciones</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-y-el-lineup"><i class="fa fa-check"></i>Prueba de permutaciones y el <em>lineup</em></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparaciones-usando-lineup-continuación"><i class="fa fa-check"></i>Comparaciones usando <em>lineup</em> (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-para-proporciones"><i class="fa fa-check"></i>Prueba de permutaciones para proporciones</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-hipótesis-tradicionales"><i class="fa fa-check"></i>Pruebas de hipótesis tradicionales</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#tomadores-de-té-continuación"><i class="fa fa-check"></i>Tomadores de té (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-permutación-problemas-en-implementación."><i class="fa fa-check"></i>Pruebas de permutación: problemas en implementación.</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión-continuación"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#separación-de-grupos"><i class="fa fa-check"></i>Separación de grupos</a>
<ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#avispas-opcional"><i class="fa fa-check"></i>Avispas (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#la-crisis-de-replicabilidad"><i class="fa fa-check"></i>La “crisis de replicabilidad”</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#el-jardín-de-los-senderos-que-se-bifurcan"><i class="fa fa-check"></i>El jardín de los senderos que se bifurcan</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-decisiones-de-análisis-y-valores-p"><i class="fa fa-check"></i>Ejemplo: decisiones de análisis y valores <em>p</em></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#alternativas-o-soluciones"><i class="fa fa-check"></i>Alternativas o soluciones</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html"><i class="fa fa-check"></i><b>4</b> Estimación y distribución de muestreo</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-precios-de-casas"><i class="fa fa-check"></i>Ejemplo: precios de casas</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#distribución-de-muestreo"><i class="fa fa-check"></i>Distribución de muestreo</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#más-ejemplos"><i class="fa fa-check"></i>Más ejemplos</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#el-error-estándar"><i class="fa fa-check"></i>El error estándar</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-valor-de-casas"><i class="fa fa-check"></i>Ejemplo: valor de casas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#calculando-la-distribución-de-muestreo"><i class="fa fa-check"></i>Calculando la distribución de muestreo</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#teorema-central-del-límite"><i class="fa fa-check"></i>Teorema central del límite</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#normalidad-y-gráficas-de-cuantiles-normales"><i class="fa fa-check"></i>Normalidad y gráficas de cuantiles normales</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#prueba-de-hipótesis-de-normalidad"><i class="fa fa-check"></i>Prueba de hipótesis de normalidad</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="estimación-y-distribución-de-muestreo-1.html"><a href="estimación-y-distribución-de-muestreo-1.html#más-del-teorema-central-del-límite"><i class="fa fa-check"></i>Más del Teorema central del límite</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html"><i class="fa fa-check"></i><b>5</b> Intervalos de confianza y remuestreo</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-introductorio"><i class="fa fa-check"></i>Ejemplo introductorio</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#la-idea-del-bootstrap"><i class="fa fa-check"></i>La idea del bootstrap</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#el-principio-de-plug-in"><i class="fa fa-check"></i>El principio de plug-in</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#discusión-propiedades-de-la-distribución-bootstrap"><i class="fa fa-check"></i>Discusión: propiedades de la distribución bootstrap</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#error-estándar-bootstrap-e-intervalos-normales"><i class="fa fa-check"></i>Error estándar bootstrap e intervalos normales</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-tomadores-de-té-negro"><i class="fa fa-check"></i>Ejemplo: tomadores de té negro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-inventario-de-casas-vendidas"><i class="fa fa-check"></i>Ejemplo: inventario de casas vendidas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#calibración-de-intervalos-de-confianza"><i class="fa fa-check"></i>Calibración de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#interpretación-de-intervalos-de-confianza"><i class="fa fa-check"></i>Interpretación de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#sesgo"><i class="fa fa-check"></i>Sesgo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#intervalos-bootstrap-de-percentiles"><i class="fa fa-check"></i>Intervalos bootstrap de percentiles</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-para-dos-muestras"><i class="fa fa-check"></i>Bootstrap para dos muestras</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-9"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#datos-pareados"><i class="fa fa-check"></i>Datos pareados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-otras-estadísticas"><i class="fa fa-check"></i>Bootstrap y otras estadísticas</a>
<ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-estimadores-de-razón"><i class="fa fa-check"></i>Ejemplo: estimadores de razón</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-suavizadores"><i class="fa fa-check"></i>Ejemplo: suavizadores</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-estimadores-complejos-tablas-de-perfiles"><i class="fa fa-check"></i>Bootstrap y estimadores complejos: tablas de perfiles</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-muestras-complejas"><i class="fa fa-check"></i>Bootstrap y muestras complejas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-en-r"><i class="fa fa-check"></i>Bootstrap en R</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#conclusiones-y-observaciones"><i class="fa fa-check"></i>Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html"><i class="fa fa-check"></i><b>6</b> Estimación por máxima verosimilitud</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#introducción-a-estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Introducción a estimación por máxima verosimilitud</a></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#máxima-verosimilitud-para-observaciones-continuas"><i class="fa fa-check"></i>Máxima verosimilitud para observaciones continuas</a></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#aspectos-numéricos"><i class="fa fa-check"></i>Aspectos numéricos</a>
<ul>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#el-método-de-momentos"><i class="fa fa-check"></i>El método de momentos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#máxima-verosimilitud-para-más-de-un-parámetro"><i class="fa fa-check"></i>Máxima verosimilitud para más de un parámetro</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html"><i class="fa fa-check"></i><b>7</b> <em>Bootstrap</em> paramétrico</a>
<ul>
<li class="chapter" data-level="" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html#ventajas-y-desventajas-de-bootstrap-paramétrico"><i class="fa fa-check"></i>Ventajas y desventajas de <em>bootstrap</em> paramétrico</a></li>
<li class="chapter" data-level="" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html#verificando-los-supuestos-distribucionales"><i class="fa fa-check"></i>Verificando los supuestos distribucionales</a></li>
<li class="chapter" data-level="" data-path="bootstrap-paramétrico.html"><a href="bootstrap-paramétrico.html#modelos-mal-identificados"><i class="fa fa-check"></i>Modelos mal identificados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html"><i class="fa fa-check"></i>Apéndice: Principios de visualizacion</a>
<ul>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#el-cuarteto-de-anscombe"><i class="fa fa-check"></i>El cuarteto de Anscombe</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#introducción"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#teoría-de-visualización-de-datos"><i class="fa fa-check"></i>Teoría de visualización de datos</a>
<ul>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#técnicas-de-visualización"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#factor-de-engaño-y-chartjunk"><i class="fa fa-check"></i>Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#pequeños-múltiplos-y-densidad-gráfica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#decoración"><i class="fa fa-check"></i>Decoración</a></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#percepción-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="apéndice-principios-de-visualizacion.html"><a href="apéndice-principios-de-visualizacion.html#ejemplo-gráfica-de-minard"><i class="fa fa-check"></i>Ejemplo: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a>
<ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#visualización"><i class="fa fa-check"></i>1. Visualización</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#análisis-exploratorio-1"><i class="fa fa-check"></i>2. Análisis Exploratorio</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tipos-de-estudio-y-pgd"><i class="fa fa-check"></i>3. Tipos de estudio y PGD</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#pruebas-de-hipótesis-visuales-y-de-permutación"><i class="fa fa-check"></i>4. Pruebas de hipótesis visuales y de permutación</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#distribución-muestral"><i class="fa fa-check"></i>5. Distribución muestral</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tcl-e-introducción-a-bootstrap"><i class="fa fa-check"></i>6. TCL e introducción a bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/tereom/fundamentos-2022" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentos de Estadística con Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrap-paramétrico" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Sección 7</span> <em>Bootstrap</em> paramétrico<a href="bootstrap-paramétrico.html#bootstrap-paramétrico" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Cuando nuestras observaciones provienen de un modelo teórico parametrizado
con algunos parámetros que queremos estimar, y utilizamos máxima verosimilitud
para hacer nuestra estimación, no es adecuado aplicar directamente el <em>bootstrap</em> no
paramétrico que vimos en las secciones anteriores.</p>
<p>Sin embargo, suponiendo que el modelo paramétrico que estamos usando es apropiado,
podemos remuestrear de tal modelo para estimar la varianza de nuestros estimadores.
Este proceso se llama el <strong><em>bootstrap</em> paramétrico</strong>. Antes de hacer una definición
precisa, veamos cómo calcularíamos error estándar para los estimadores de máxima
verosimilitud de la normal que vimos en la sección anterior.</p>
<p><strong>Ejemplo (sección máxima verosimilitud)</strong>. Como ejercicio, podemos encontrar los estimadores de máxima
verosimilitud cuando tenemos una muestra <span class="math inline">\(X_1, \ldots, X_n \sim \mathsf{N}(\mu, \sigma^2)\)</span>
(puedes derivar e igualar a cero para encontrar el mínimo). También podemos resolver numéricamente.</p>
<p>Supongamos que tenemos la siguiente muestra:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="bootstrap-paramétrico.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">41852</span>)</span>
<span id="cb315-2"><a href="bootstrap-paramétrico.html#cb315-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">150</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>La función generadora de la log-verosimilitud para una muestra es (ve la expresión
del ejercicio anterior y calcula su logaritmo), y generamos la función de verosimilitud
para nuestra muestra:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="bootstrap-paramétrico.html#cb316-1" aria-hidden="true" tabindex="-1"></a>crear_log_p <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb316-2"><a href="bootstrap-paramétrico.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  log_p <span class="ot">&lt;-</span> <span class="cf">function</span>(pars){</span>
<span id="cb316-3"><a href="bootstrap-paramétrico.html#cb316-3" aria-hidden="true" tabindex="-1"></a>    media <span class="ot">=</span> pars[<span class="dv">1</span>]</span>
<span id="cb316-4"><a href="bootstrap-paramétrico.html#cb316-4" aria-hidden="true" tabindex="-1"></a>    desv_est <span class="ot">=</span> pars[<span class="dv">2</span>]</span>
<span id="cb316-5"><a href="bootstrap-paramétrico.html#cb316-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ve la ecuación del ejercicio anterior</span></span>
<span id="cb316-6"><a href="bootstrap-paramétrico.html#cb316-6" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> (x <span class="sc">-</span> media) <span class="sc">/</span> desv_est</span>
<span id="cb316-7"><a href="bootstrap-paramétrico.html#cb316-7" aria-hidden="true" tabindex="-1"></a>    log_verosim <span class="ot">&lt;-</span> <span class="sc">-</span>(<span class="fu">log</span>(desv_est) <span class="sc">+</span>  <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">mean</span>(z<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb316-8"><a href="bootstrap-paramétrico.html#cb316-8" aria-hidden="true" tabindex="-1"></a>    log_verosim</span>
<span id="cb316-9"><a href="bootstrap-paramétrico.html#cb316-9" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb316-10"><a href="bootstrap-paramétrico.html#cb316-10" aria-hidden="true" tabindex="-1"></a>  log_p</span>
<span id="cb316-11"><a href="bootstrap-paramétrico.html#cb316-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb316-12"><a href="bootstrap-paramétrico.html#cb316-12" aria-hidden="true" tabindex="-1"></a>log_p <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra)</span></code></pre></div>
<p>Ahora optimizamos (checa que el método converge):</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="bootstrap-paramétrico.html#cb317-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), log_p, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>), <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb317-2"><a href="bootstrap-paramétrico.html#cb317-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>convergence</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="bootstrap-paramétrico.html#cb319-1" aria-hidden="true" tabindex="-1"></a>est_mle <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">parametro =</span> <span class="fu">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="at">estimador =</span> res<span class="sc">$</span>par) <span class="sc">%&gt;%</span> </span>
<span id="cb319-2"><a href="bootstrap-paramétrico.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;parametro&quot;</span>)</span></code></pre></div>
<p>Una vez que tenemos nuestros estimadores puntuales,</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="bootstrap-paramétrico.html#cb320-1" aria-hidden="true" tabindex="-1"></a>est_mle</span></code></pre></div>
<pre><code>##       estimador
## media  1.136001
## sigma  1.838421</code></pre>
<p>Sustituimos estos parámetros en la distribución normal y simulamos una muestra del
mismo tamaño que la original:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="bootstrap-paramétrico.html#cb322-1" aria-hidden="true" tabindex="-1"></a>simular_modelo <span class="ot">&lt;-</span> <span class="cf">function</span>(n, media, sigma){</span>
<span id="cb322-2"><a href="bootstrap-paramétrico.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(n, media, sigma)</span>
<span id="cb322-3"><a href="bootstrap-paramétrico.html#cb322-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb322-4"><a href="bootstrap-paramétrico.html#cb322-4" aria-hidden="true" tabindex="-1"></a>muestra_bootstrap <span class="ot">&lt;-</span> <span class="fu">simular_modelo</span>(<span class="fu">length</span>(muestra), </span>
<span id="cb322-5"><a href="bootstrap-paramétrico.html#cb322-5" aria-hidden="true" tabindex="-1"></a>                                    est_mle[<span class="st">&quot;media&quot;</span>, <span class="st">&quot;estimador&quot;</span>],</span>
<span id="cb322-6"><a href="bootstrap-paramétrico.html#cb322-6" aria-hidden="true" tabindex="-1"></a>                                    est_mle[<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;estimador&quot;</span>])</span>
<span id="cb322-7"><a href="bootstrap-paramétrico.html#cb322-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(muestra_bootstrap)</span></code></pre></div>
<pre><code>## [1]  1.8583885  2.2084326  2.5852895  2.5174462 -0.7428032  0.5995989</code></pre>
<p>Una vez que tenemos esta muestra <em>bootstrap</em> recalculamos los estimadores de máxima
verosimlitud. Esto se hace optimizando:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="bootstrap-paramétrico.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creamos nueva verosimilitud para muestra bootstrap</span></span>
<span id="cb324-2"><a href="bootstrap-paramétrico.html#cb324-2" aria-hidden="true" tabindex="-1"></a>log_p_boot <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra_bootstrap)</span>
<span id="cb324-3"><a href="bootstrap-paramétrico.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="co"># optimizamos</span></span>
<span id="cb324-4"><a href="bootstrap-paramétrico.html#cb324-4" aria-hidden="true" tabindex="-1"></a>res_boot <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), log_p_boot, </span>
<span id="cb324-5"><a href="bootstrap-paramétrico.html#cb324-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>), <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb324-6"><a href="bootstrap-paramétrico.html#cb324-6" aria-hidden="true" tabindex="-1"></a>res_boot<span class="sc">$</span>convergence</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="bootstrap-paramétrico.html#cb326-1" aria-hidden="true" tabindex="-1"></a>est_mle_boot <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">parametro =</span> <span class="fu">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="at">estimador =</span> res_boot<span class="sc">$</span>par) <span class="sc">%&gt;%</span> </span>
<span id="cb326-2"><a href="bootstrap-paramétrico.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;parametro&quot;</span>)</span>
<span id="cb326-3"><a href="bootstrap-paramétrico.html#cb326-3" aria-hidden="true" tabindex="-1"></a>est_mle_boot</span></code></pre></div>
<pre><code>##       estimador
## media  1.235914
## sigma  1.710042</code></pre>
<p>Y esta es nuestra replicación <em>bootstrap</em> de los estimadores de máxima verosimilitud.</p>
<p>La idea es la misma que el <em>bootstrap</em>, con la ventaja de que estamos simulando
del modelo que suponemos es el correcto, es decir, estamos usando información adicional
que no teníamos en el <em>bootstrap</em> no paramétrico. Ahora es necesario repetir un
número grande de veces.</p>
<p>Nótese que esta función solo envuelve el proceso de remuestreo,
cálculo de la función de verosimilitud y optimización:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="bootstrap-paramétrico.html#cb328-1" aria-hidden="true" tabindex="-1"></a>rep_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(rep, crear_log_p, est_mle, n){</span>
<span id="cb328-2"><a href="bootstrap-paramétrico.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  muestra_bootstrap <span class="ot">&lt;-</span> <span class="fu">simular_modelo</span>(<span class="fu">length</span>(muestra), </span>
<span id="cb328-3"><a href="bootstrap-paramétrico.html#cb328-3" aria-hidden="true" tabindex="-1"></a>                               est_mle[<span class="st">&quot;media&quot;</span>, <span class="st">&quot;estimador&quot;</span>], </span>
<span id="cb328-4"><a href="bootstrap-paramétrico.html#cb328-4" aria-hidden="true" tabindex="-1"></a>                               est_mle[<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;estimador&quot;</span>])</span>
<span id="cb328-5"><a href="bootstrap-paramétrico.html#cb328-5" aria-hidden="true" tabindex="-1"></a>  log_p_boot <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra_bootstrap)</span>
<span id="cb328-6"><a href="bootstrap-paramétrico.html#cb328-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># optimizamos</span></span>
<span id="cb328-7"><a href="bootstrap-paramétrico.html#cb328-7" aria-hidden="true" tabindex="-1"></a>  res_boot <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), log_p_boot, </span>
<span id="cb328-8"><a href="bootstrap-paramétrico.html#cb328-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>), <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb328-9"><a href="bootstrap-paramétrico.html#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">try</span>(<span class="cf">if</span>(res_boot<span class="sc">$</span>convergence <span class="sc">!=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;No se alcanzó convergencia.&quot;</span>))</span>
<span id="cb328-10"><a href="bootstrap-paramétrico.html#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">parametro =</span> <span class="fu">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="at">estimador_boot =</span> res_boot<span class="sc">$</span>par) </span>
<span id="cb328-11"><a href="bootstrap-paramétrico.html#cb328-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb328-12"><a href="bootstrap-paramétrico.html#cb328-12" aria-hidden="true" tabindex="-1"></a>reps_boot <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>, <span class="sc">~</span> <span class="fu">rep_boot</span>(.x, crear_log_p, est_mle, </span>
<span id="cb328-13"><a href="bootstrap-paramétrico.html#cb328-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">n =</span> <span class="fu">length</span>(muestra)), <span class="at">rep =</span> <span class="st">&quot;.id&quot;</span>) </span>
<span id="cb328-14"><a href="bootstrap-paramétrico.html#cb328-14" aria-hidden="true" tabindex="-1"></a>reps_boot</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 2
##    parametro estimador_boot
##    &lt;chr&gt;              &lt;dbl&gt;
##  1 media              0.797
##  2 sigma              1.90 
##  3 media              1.23 
##  4 sigma              1.96 
##  5 media              1.14 
##  6 sigma              1.89 
##  7 media              1.33 
##  8 sigma              1.73 
##  9 media              1.19 
## 10 sigma              1.73 
## # … with 9,990 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<p>Ya ahora podemos estimar error estándar:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="bootstrap-paramétrico.html#cb330-1" aria-hidden="true" tabindex="-1"></a>error_est <span class="ot">&lt;-</span> reps_boot <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(parametro) <span class="sc">%&gt;%</span> </span>
<span id="cb330-2"><a href="bootstrap-paramétrico.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ee_boot =</span> <span class="fu">sd</span>(estimador_boot)) </span>
<span id="cb330-3"><a href="bootstrap-paramétrico.html#cb330-3" aria-hidden="true" tabindex="-1"></a>error_est</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   parametro ee_boot
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 media       0.150
## 2 sigma       0.106</code></pre>
<p>Así que nuestra estimación final sería:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="bootstrap-paramétrico.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(est_mle, error_est) <span class="sc">%&gt;%</span> </span>
<span id="cb332-2"><a href="bootstrap-paramétrico.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb332-3"><a href="bootstrap-paramétrico.html#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parametro, estimador, ee_boot)</span></code></pre></div>
<pre><code>##       parametro estimador ee_boot
## media     media     1.136   0.150
## sigma     sigma     1.838   0.106</code></pre>
<p>Si usamos la rutina estándar de <code>R</code> (dejaremos para después explicar cómo
calcula los errores estándar esta rutina —no es con bootstrap):</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="bootstrap-paramétrico.html#cb334-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(MASS<span class="sc">::</span><span class="fu">fitdistr</span>(muestra, <span class="st">&quot;normal&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   term  estimate std.error
##   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 mean      1.14     0.150
## 2 sd        1.84     0.106</code></pre>
<p>Podemos checar también la normalidad aproximada de las distribuciones
bootstrap para construir nuestros intervalos:</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="bootstrap-paramétrico.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reps_boot, <span class="fu">aes</span>(<span class="at">sample =</span> estimador_boot)) <span class="sc">+</span> </span>
<span id="cb336-2"><a href="bootstrap-paramétrico.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb336-3"><a href="bootstrap-paramétrico.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parametro, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;" />
La distribuciones son aproximadamente normales. Nótese que esto no siempre
sucede, especialmente con parámetros de dispersión como <span class="math inline">\(\sigma\)</span>.</p>
<p><strong>Ejemplo</strong>. Supongamos que tenemos una muestra más chica. Repasa los pasos
para asegurarte que entiendes el procedimiento:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="bootstrap-paramétrico.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4182</span>)</span>
<span id="cb337-2"><a href="bootstrap-paramétrico.html#cb337-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb337-3"><a href="bootstrap-paramétrico.html#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="co"># función de verosimilitud</span></span>
<span id="cb337-4"><a href="bootstrap-paramétrico.html#cb337-4" aria-hidden="true" tabindex="-1"></a>log_p <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra)</span>
<span id="cb337-5"><a href="bootstrap-paramétrico.html#cb337-5" aria-hidden="true" tabindex="-1"></a><span class="co"># máxima verosimilitud</span></span>
<span id="cb337-6"><a href="bootstrap-paramétrico.html#cb337-6" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), log_p, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>), <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb337-7"><a href="bootstrap-paramétrico.html#cb337-7" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>convergence</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="bootstrap-paramétrico.html#cb339-1" aria-hidden="true" tabindex="-1"></a>est_mle <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">parametro =</span> <span class="fu">c</span>(<span class="st">&quot;media&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="at">estimador =</span> res<span class="sc">$</span>par) <span class="sc">%&gt;%</span> </span>
<span id="cb339-2"><a href="bootstrap-paramétrico.html#cb339-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;parametro&quot;</span>)</span>
<span id="cb339-3"><a href="bootstrap-paramétrico.html#cb339-3" aria-hidden="true" tabindex="-1"></a>est_mle</span></code></pre></div>
<pre><code>##       estimador
## media 0.3982829
## sigma 2.3988969</code></pre>
<p>Hacemos <em>bootstrap</em> paramétrico</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="bootstrap-paramétrico.html#cb341-1" aria-hidden="true" tabindex="-1"></a>reps_boot <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>, <span class="sc">~</span> <span class="fu">rep_boot</span>(.x, crear_log_p, est_mle, <span class="at">n =</span> <span class="fu">length</span>(muestra)), <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span>) </span>
<span id="cb341-2"><a href="bootstrap-paramétrico.html#cb341-2" aria-hidden="true" tabindex="-1"></a>reps_boot</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 3
##    rep   parametro estimador_boot
##    &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;
##  1 1     media              0.789
##  2 1     sigma              0.945
##  3 2     media             -0.103
##  4 2     sigma              1.37 
##  5 3     media              1.96 
##  6 3     sigma              1.70 
##  7 4     media              1.55 
##  8 4     sigma              2.28 
##  9 5     media             -0.228
## 10 5     sigma              1.73 
## # … with 9,990 more rows
## # ℹ Use `print(n = ...)` to see more rows</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="bootstrap-paramétrico.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reps_boot, <span class="fu">aes</span>(<span class="at">sample =</span> estimador_boot)) <span class="sc">+</span> </span>
<span id="cb343-2"><a href="bootstrap-paramétrico.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb343-3"><a href="bootstrap-paramétrico.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parametro, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="bootstrap-paramétrico.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reps_boot, <span class="fu">aes</span>(<span class="at">x =</span> estimador_boot)) <span class="sc">+</span></span>
<span id="cb344-2"><a href="bootstrap-paramétrico.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>parametro)</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-14-2.png" width="480" style="display: block; margin: auto;" /></p>
<p>Donde vemos que la distribución de <span class="math inline">\(\sigma\)</span> tienen sesgo a la derecha, pues en algunos
casos obtenemos estimaciones muy cercanas a cero. Podemos
usar intervalos de percentiles.</p>
<p><strong>Ejercicio (extra)</strong>. Con más de un parámetro, podemos preguntarnos cómo dependen
las estimaciones individuales - en algunos casos pueden estar correlacionadas. Podemos
examinar este comportamiendo visualizando las replicaciones bootstrap</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="bootstrap-paramétrico.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reps_boot <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> parametro, <span class="at">values_from =</span> estimador_boot),</span>
<span id="cb345-2"><a href="bootstrap-paramétrico.html#cb345-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> media, <span class="at">y =</span> sigma)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;" />
Esta es nuestra aproximación a la distribución de remuestreo de nuestro
par de estadísticas <span class="math inline">\((\mu_{\mathsf{MLE}}, \sigma_{\mathsf{MLE}})\)</span>. En este caso, parecen ser
independientes (lo cual es posible demostrar).</p>
<div class="mathblock">
<p>
<strong>Bootstrap paramétrico</strong>. Supongamos que tenemos una
muestra iid <span class="math inline"><span class="math inline">\(X_1,X_2,\ldots, X_n \sim f(x;\theta)\)</span></span> de un modelo paramétrico, y un estimador de máxima
verosimilitud <span class="math inline"><span class="math inline">\(\hat{\theta}_{\mathsf{MLE}}\)</span></span> para <span class="math inline"><span class="math inline">\(\theta\)</span></span>. El error estándar estimado para
<span class="math inline"><span class="math inline">\(\hat{\theta}_{\mathsf{MLE}}\)</span></span> por
medio del bootstrap paramétrico se calcula como sigue:
</p>
<ol style="list-style-type: decimal">
<li>
Se calcula <span class="math inline"><span class="math inline">\(\hat{\theta}_{\mathsf{MLE}}\)</span></span> para la
muestra observada
</li>
<li>
Se simula una muestra iid de tamaño <span class="math inline"><span class="math inline">\(n\)</span></span> de <span class="math inline"><span class="math inline">\(f(x; \hat{\theta}_{\mathsf{MLE}})\)</span></span> (muestra bootstrap)
</li>
<li>
Se recalcula el estimador de máxima verosimilitud para la muestra
<em>bootstrap</em> <span class="math inline"><span class="math inline">\(\hat{\theta^*}_{\mathsf{MLE}}\)</span></span>
</li>
<li>
Se repiten 2-3 una cantidad grande de veces (1000 - 10000)
</li>
<li>
Se calcula la desviación estándar de los valores <span class="math inline"><span class="math inline">\(\hat{\theta^*}_{\mathsf{MLE}}\)</span></span> obtenidos.
Este es el error estándar estimado para el estimador <span class="math inline"><span class="math inline">\(\hat{\theta}_{\mathsf{MLE}}\)</span></span>
</li>
</ol>
</div>
<div id="ventajas-y-desventajas-de-bootstrap-paramétrico" class="section level2 unnumbered hasAnchor">
<h2>Ventajas y desventajas de <em>bootstrap</em> paramétrico<a href="bootstrap-paramétrico.html#ventajas-y-desventajas-de-bootstrap-paramétrico" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Ventaja: el <em>bootstrap</em> paramétrico puede dar estimadores más precisos e intervalos
más angostos y bien calibrados que el no paramétrico, <strong>siempre y cuando el modelo
teórico sea razonable.</strong></p></li>
<li><p>Desventaja: Es necesario decidir el modelo teórico, que tendrá cierto grado de
desajuste vs. el proceso generador real de los datos. Si el ajuste es muy malo, los resultados
tienen poca utilidad. Para el no paramétrico no es necesario hacer supuestos teóricos.</p></li>
<li><p>Ventaja: el <em>bootstrap</em> paramétrico puede ser más escalable que el no paramétrico, pues no es necesario cargar y remuestrear los datos originales, y tenemos mejoras adicionales cuando tenemos expresiones explícitas
para los estimadores de máxima verosimilitud (como en el caso normal, donde es innecesario
hacer optimización numérica).</p></li>
<li><p>Desventaja: el <em>bootstrap</em> paramétrico es conceptualmente más complicado que el
no paramétrico, y como vimos arriba, sus supuestos pueden ser más frágiles que los del
no-paramétrico.</p></li>
</ul>
</div>
<div id="verificando-los-supuestos-distribucionales" class="section level2 unnumbered hasAnchor">
<h2>Verificando los supuestos distribucionales<a href="bootstrap-paramétrico.html#verificando-los-supuestos-distribucionales" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como hemos discutido antes, podemos hacer pruebas de hipótesis para checar si una muestra
dada proviene de una distribución conocida. Sin embargo, la herramienta más común es
la de los qq-plots, donde podemos juzgar fácilmente el tamaño de las desviaciones
y si estas tienen implicaciones prácticas importantes.</p>
<p>El proceso es como sigue: si <span class="math inline">\(X_1,X_,\ldots, X_n\)</span> es una muestra de <span class="math inline">\(f(x;\theta)\)</span>,
calculamos el estimador de máxima verosimilitud <span class="math inline">\(\theta_{\mathsf{MLE}}\)</span> con los datos
observados. Enchufamos <span class="math inline">\(\hat{f} = f(x;\theta_{\mathsf{MLE}})\)</span>, y hacemos una gráfica
de los cuantiles teóricos de <span class="math inline">\(\hat{f}\)</span> contra los cuantiles muestrales.</p>
<p><strong>Ejemplo</strong>. Consideramos la siguiente muestra:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="bootstrap-paramétrico.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb346-2"><a href="bootstrap-paramétrico.html#cb346-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">150</span>, <span class="fl">0.4</span>, <span class="dv">1</span>)</span>
<span id="cb346-3"><a href="bootstrap-paramétrico.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(muestra) </span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Y queremos usar un modelo exponencial. Encontramos los estimadores de maxima
verosimilitud</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="bootstrap-paramétrico.html#cb347-1" aria-hidden="true" tabindex="-1"></a>est_mle <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">fitdistr</span>(muestra, <span class="st">&quot;exponential&quot;</span>)</span>
<span id="cb347-2"><a href="bootstrap-paramétrico.html#cb347-2" aria-hidden="true" tabindex="-1"></a>rate_mle <span class="ot">&lt;-</span> est_mle<span class="sc">$</span>estimate</span>
<span id="cb347-3"><a href="bootstrap-paramétrico.html#cb347-3" aria-hidden="true" tabindex="-1"></a>rate_mle</span></code></pre></div>
<pre><code>##    rate 
## 2.76054</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="bootstrap-paramétrico.html#cb349-1" aria-hidden="true" tabindex="-1"></a>g_exp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">muestra =</span> muestra), <span class="fu">aes</span>(<span class="at">sample =</span> muestra)) <span class="sc">+</span></span>
<span id="cb349-2"><a href="bootstrap-paramétrico.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qexp, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">rate =</span> rate_mle)) <span class="sc">+</span></span>
<span id="cb349-3"><a href="bootstrap-paramétrico.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Gráfica de cuantiles exponenciales&quot;</span>)</span>
<span id="cb349-4"><a href="bootstrap-paramétrico.html#cb349-4" aria-hidden="true" tabindex="-1"></a>g_exp</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Donde vemos que el desajuste es considerable, y los datos tienen
una cola derecha considerablemente más larga que la de exponencial (datos son
casi dos veces más grande de lo que esperaríamos), y la cola
izquierda está más comprimida en los datos que en una exponencial.</p>
<p>Sin embargo, si ajustamos una gamma:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="bootstrap-paramétrico.html#cb350-1" aria-hidden="true" tabindex="-1"></a>est_mle <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">fitdistr</span>(muestra, <span class="st">&quot;gamma&quot;</span>)<span class="sc">$</span>estimate</span>
<span id="cb350-2"><a href="bootstrap-paramétrico.html#cb350-2" aria-hidden="true" tabindex="-1"></a>g_gamma <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">muestra =</span> muestra), <span class="fu">aes</span>(<span class="at">sample =</span> muestra)) <span class="sc">+</span></span>
<span id="cb350-3"><a href="bootstrap-paramétrico.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qgamma, </span>
<span id="cb350-4"><a href="bootstrap-paramétrico.html#cb350-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">shape =</span> est_mle[<span class="dv">1</span>], <span class="at">rate =</span> est_mle[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb350-5"><a href="bootstrap-paramétrico.html#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Gráfica de cuantiles gamma&quot;</span>)</span>
<span id="cb350-6"><a href="bootstrap-paramétrico.html#cb350-6" aria-hidden="true" tabindex="-1"></a>g_exp <span class="sc">+</span> g_gamma</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>El ajuste es considerablemente mejor para la distribución gamma
(puedes hacer el protocolo <em>rorschach</em> para
afinar tu diagnóstico de este tipo de gráficas).</p>
<p><strong>Ejempĺo</strong>. Examinamos un modelo teórico para las cuentas totales del
conjunto de datos de propinas. En primer lugar:</p>
<ol style="list-style-type: decimal">
<li>Separamos comida y cena, pues sabemos que las cuentas tienden a ser
más grandes en las cenas.</li>
<li>En lugar de modelar la cuenta total, modelamos el gasto por persona, es decir,
la cuenta total dividida por el numero de personas. Grupos grandes pueden
producir colas largas que no tenemos necesidad de modelar de manera
probabilística, pues conocemos
el número de personas.</li>
</ol>
<p>En este caso intentaremos un modelo lognormal, es decir, el logaritmo de los
valores observados se comporta aproximadamente normal. Puedes también intentar con
una distribución gamma.</p>
<p>Separamos por Cena y Comida, dividimos entre número de personas y probamos
ajustando un modelo para cada horario:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="bootstrap-paramétrico.html#cb351-1" aria-hidden="true" tabindex="-1"></a>propinas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/propinas.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb351-2"><a href="bootstrap-paramétrico.html#cb351-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">cuenta_persona =</span> cuenta_total <span class="sc">/</span> num_personas)</span>
<span id="cb351-3"><a href="bootstrap-paramétrico.html#cb351-3" aria-hidden="true" tabindex="-1"></a>propinas_mle <span class="ot">&lt;-</span> propinas <span class="sc">%&gt;%</span> </span>
<span id="cb351-4"><a href="bootstrap-paramétrico.html#cb351-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(momento) <span class="sc">%&gt;%</span> </span>
<span id="cb351-5"><a href="bootstrap-paramétrico.html#cb351-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">est_mle =</span> <span class="fu">list</span>(<span class="fu">tidy</span>(MASS<span class="sc">::</span><span class="fu">fitdistr</span>(cuenta_persona, <span class="st">&quot;lognormal&quot;</span>))))  <span class="sc">%&gt;%</span> </span>
<span id="cb351-6"><a href="bootstrap-paramétrico.html#cb351-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(est_mle)</span>
<span id="cb351-7"><a href="bootstrap-paramétrico.html#cb351-7" aria-hidden="true" tabindex="-1"></a>propinas_mle </span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
##   momento term    estimate std.error
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1 Cena    meanlog    2.03     0.0273
## 2 Cena    sdlog      0.362    0.0193
## 3 Comida  meanlog    1.94     0.0366
## 4 Comida  sdlog      0.302    0.0259</code></pre>
<p>Ojo: estos parámetros están en escala logarítmica. Puedes revisar <a href="https://en.wikipedia.org/wiki/Log-normal_distribution">aquí</a>
para ver cómo calcular media y desviación estándar de las distribuciones originales.
Ahora verificamos el ajuste:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="bootstrap-paramétrico.html#cb353-1" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(propinas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(momento <span class="sc">==</span> <span class="st">&quot;Cena&quot;</span>), <span class="fu">aes</span>(<span class="at">sample =</span> cuenta_persona)) <span class="sc">+</span></span>
<span id="cb353-2"><a href="bootstrap-paramétrico.html#cb353-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">mean =</span> propinas_mle<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">sd =</span> propinas_mle<span class="sc">$</span>estimate[<span class="dv">2</span>]),</span>
<span id="cb353-3"><a href="bootstrap-paramétrico.html#cb353-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">distribution =</span> stats<span class="sc">::</span>qlnorm) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb353-4"><a href="bootstrap-paramétrico.html#cb353-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Cena&quot;</span>)</span>
<span id="cb353-5"><a href="bootstrap-paramétrico.html#cb353-5" aria-hidden="true" tabindex="-1"></a>g_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(propinas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(momento <span class="sc">==</span> <span class="st">&quot;Comida&quot;</span>), <span class="fu">aes</span>(<span class="at">sample =</span> cuenta_persona)) <span class="sc">+</span></span>
<span id="cb353-6"><a href="bootstrap-paramétrico.html#cb353-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>(<span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">mean =</span> propinas_mle<span class="sc">$</span>estimate[<span class="dv">3</span>], <span class="at">sd =</span> propinas_mle<span class="sc">$</span>estimate[<span class="dv">4</span>]),</span>
<span id="cb353-7"><a href="bootstrap-paramétrico.html#cb353-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">distribution =</span> stats<span class="sc">::</span>qlnorm) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb353-8"><a href="bootstrap-paramétrico.html#cb353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Comida&quot;</span>)</span>
<span id="cb353-9"><a href="bootstrap-paramétrico.html#cb353-9" aria-hidden="true" tabindex="-1"></a>g_1 <span class="sc">+</span> g_2</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;" />
El ajuste es bueno, aunque podríamos checar la cola de la derecha en la Comida:
¿por qué existen esos valores relativamente grandes (alrededor de 25% más altos
de lo que esperaríamos).</p>
<div class="ejercicio">
<ul>
<li>
¿Tiene sentido ajustar dos distribuciones con parámetros separados?
¿Crees que estas dos distribuciones podrían compartir algún parámetro?
Para esto puedes revisar el error estándar de los estimadores de máxima
verosimilitud que mostramos arriba. ¿Qué ventajas verías en usar menos
parámetros? ¿Cómo implementarías la estimación?
</li>
<li>
¿Qué pasa si intentas ajustar un modelo normal a estos datos?
</li>
</ul>
</div>
</div>
<div id="modelos-mal-identificados" class="section level2 unnumbered hasAnchor">
<h2>Modelos mal identificados<a href="bootstrap-paramétrico.html#modelos-mal-identificados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para algunos modelos y algunos parámetros, puede suceder que existan varias
configuraciones muy diferentes de los parámetros que sean consistentes con
los datos (en términos de verosimilitud, tienen verosimilitud alta similar), y
en estos casos decimos que el modelo (con los datos observados) está
<strong>mal identificado</strong>.</p>
<p>Esto presenta problemas múltiples: optimizar es más difícil,
hay incertidumbre grande en la estimación, y los parámetros se acoplan, haciendo
difícil su interpretación.</p>
<p><strong>Ejemplo.</strong> Consideremos el ejemplo anterior donde queríamos estimar dos proporciones:
la proporción de examenes contestados al azar y la tasa de correctos. Vamos a suponer
que la probabilidad de tener respuesta correcta dado que el examen no fue contestado
al azar no es muy lejano a 1/5, que es la probabilidad de acertar a al azar.</p>
<p>Aquí está la función para simular y la log verosimilitud correspondiente. Aquí vamos
a ver un problema más difícil, así que usaremos la transformación logit para las
proporciones, y no obtener resultados fuera del rango 0-1 al optimizar:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="bootstrap-paramétrico.html#cb354-1" aria-hidden="true" tabindex="-1"></a>inv_logit <span class="ot">&lt;-</span> <span class="cf">function</span>(theta){</span>
<span id="cb354-2"><a href="bootstrap-paramétrico.html#cb354-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(theta) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(theta))</span>
<span id="cb354-3"><a href="bootstrap-paramétrico.html#cb354-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-4"><a href="bootstrap-paramétrico.html#cb354-4" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb354-5"><a href="bootstrap-paramétrico.html#cb354-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(p <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb354-6"><a href="bootstrap-paramétrico.html#cb354-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-7"><a href="bootstrap-paramétrico.html#cb354-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simular datos</span></span>
<span id="cb354-8"><a href="bootstrap-paramétrico.html#cb354-8" aria-hidden="true" tabindex="-1"></a>sim_formas <span class="ot">&lt;-</span> <span class="cf">function</span>(probs){</span>
<span id="cb354-9"><a href="bootstrap-paramétrico.html#cb354-9" aria-hidden="true" tabindex="-1"></a>  p_azar <span class="ot">&lt;-</span> probs[<span class="dv">1</span>]</span>
<span id="cb354-10"><a href="bootstrap-paramétrico.html#cb354-10" aria-hidden="true" tabindex="-1"></a>  p_corr <span class="ot">&lt;-</span> probs[<span class="dv">2</span>]</span>
<span id="cb354-11"><a href="bootstrap-paramétrico.html#cb354-11" aria-hidden="true" tabindex="-1"></a>  tipo <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">-</span> p_azar)</span>
<span id="cb354-12"><a href="bootstrap-paramétrico.html#cb354-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(tipo<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb354-13"><a href="bootstrap-paramétrico.html#cb354-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># al azar</span></span>
<span id="cb354-14"><a href="bootstrap-paramétrico.html#cb354-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb354-15"><a href="bootstrap-paramétrico.html#cb354-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb354-16"><a href="bootstrap-paramétrico.html#cb354-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no al azar</span></span>
<span id="cb354-17"><a href="bootstrap-paramétrico.html#cb354-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">10</span>, p_corr)</span>
<span id="cb354-18"><a href="bootstrap-paramétrico.html#cb354-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb354-19"><a href="bootstrap-paramétrico.html#cb354-19" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb354-20"><a href="bootstrap-paramétrico.html#cb354-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-21"><a href="bootstrap-paramétrico.html#cb354-21" aria-hidden="true" tabindex="-1"></a>simular_modelo <span class="ot">&lt;-</span> <span class="cf">function</span>(n, params){</span>
<span id="cb354-22"><a href="bootstrap-paramétrico.html#cb354-22" aria-hidden="true" tabindex="-1"></a>  muestra <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="sc">~</span> <span class="fu">sim_formas</span>(<span class="at">probs =</span> <span class="fu">inv_logit</span>(params)))</span>
<span id="cb354-23"><a href="bootstrap-paramétrico.html#cb354-23" aria-hidden="true" tabindex="-1"></a>  muestra</span>
<span id="cb354-24"><a href="bootstrap-paramétrico.html#cb354-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-25"><a href="bootstrap-paramétrico.html#cb354-25" aria-hidden="true" tabindex="-1"></a><span class="co"># log verosimilitud</span></span>
<span id="cb354-26"><a href="bootstrap-paramétrico.html#cb354-26" aria-hidden="true" tabindex="-1"></a>crear_log_p <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb354-27"><a href="bootstrap-paramétrico.html#cb354-27" aria-hidden="true" tabindex="-1"></a>  log_p <span class="ot">&lt;-</span> <span class="cf">function</span>(pars){</span>
<span id="cb354-28"><a href="bootstrap-paramétrico.html#cb354-28" aria-hidden="true" tabindex="-1"></a>    p_azar <span class="ot">=</span> <span class="fu">inv_logit</span>(pars[<span class="dv">1</span>])</span>
<span id="cb354-29"><a href="bootstrap-paramétrico.html#cb354-29" aria-hidden="true" tabindex="-1"></a>    p_corr <span class="ot">=</span> <span class="fu">inv_logit</span>(pars[<span class="dv">2</span>])</span>
<span id="cb354-30"><a href="bootstrap-paramétrico.html#cb354-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">log</span>(p_azar <span class="sc">*</span> <span class="fu">dbinom</span>(x, <span class="dv">10</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> p_azar) <span class="sc">*</span> <span class="fu">dbinom</span>(x, <span class="dv">10</span>, p_corr)))</span>
<span id="cb354-31"><a href="bootstrap-paramétrico.html#cb354-31" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb354-32"><a href="bootstrap-paramétrico.html#cb354-32" aria-hidden="true" tabindex="-1"></a>  log_p</span>
<span id="cb354-33"><a href="bootstrap-paramétrico.html#cb354-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb354-34"><a href="bootstrap-paramétrico.html#cb354-34" aria-hidden="true" tabindex="-1"></a><span class="co"># simular datos</span></span>
<span id="cb354-35"><a href="bootstrap-paramétrico.html#cb354-35" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb354-36"><a href="bootstrap-paramétrico.html#cb354-36" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> <span class="fu">simular_modelo</span>(<span class="dv">200</span>, <span class="at">params =</span> <span class="fu">logit</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.29</span>)))</span>
<span id="cb354-37"><a href="bootstrap-paramétrico.html#cb354-37" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(muestra)</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="bootstrap-paramétrico.html#cb355-1" aria-hidden="true" tabindex="-1"></a>log_p <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra)</span>
<span id="cb355-2"><a href="bootstrap-paramétrico.html#cb355-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>), log_p, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb355-3"><a href="bootstrap-paramétrico.html#cb355-3" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>convergence</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="bootstrap-paramétrico.html#cb357-1" aria-hidden="true" tabindex="-1"></a>est_mle <span class="ot">&lt;-</span> res<span class="sc">$</span>par</span>
<span id="cb357-2"><a href="bootstrap-paramétrico.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(est_mle) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p_azar_logit&quot;</span>, <span class="st">&quot;p_corr_logit&quot;</span>)</span>
<span id="cb357-3"><a href="bootstrap-paramétrico.html#cb357-3" aria-hidden="true" tabindex="-1"></a>est_mle</span></code></pre></div>
<pre><code>## p_azar_logit p_corr_logit 
##   -0.0343061   -0.7474912</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="bootstrap-paramétrico.html#cb359-1" aria-hidden="true" tabindex="-1"></a>probs_mle <span class="ot">&lt;-</span> <span class="fu">inv_logit</span>(est_mle)</span>
<span id="cb359-2"><a href="bootstrap-paramétrico.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(probs_mle) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p_azar&quot;</span>, <span class="st">&quot;p_corr&quot;</span>)</span>
<span id="cb359-3"><a href="bootstrap-paramétrico.html#cb359-3" aria-hidden="true" tabindex="-1"></a>probs_mle</span></code></pre></div>
<pre><code>##    p_azar    p_corr 
## 0.4914243 0.3213682</code></pre>
<p>En primer lugar, parece ser que nuestras estimaciones son menos precias. Vamos
a hacer <em>bootstrap</em> paramétrico:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="bootstrap-paramétrico.html#cb361-1" aria-hidden="true" tabindex="-1"></a>rep_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(rep, simular, crear_log_p, pars, n){</span>
<span id="cb361-2"><a href="bootstrap-paramétrico.html#cb361-2" aria-hidden="true" tabindex="-1"></a>  muestra_bootstrap <span class="ot">&lt;-</span> <span class="fu">simular</span>(n, pars)</span>
<span id="cb361-3"><a href="bootstrap-paramétrico.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  log_p_boot <span class="ot">&lt;-</span> <span class="fu">crear_log_p</span>(muestra_bootstrap)</span>
<span id="cb361-4"><a href="bootstrap-paramétrico.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># optimizamos</span></span>
<span id="cb361-5"><a href="bootstrap-paramétrico.html#cb361-5" aria-hidden="true" tabindex="-1"></a>  res_boot <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.0</span>), log_p_boot, </span>
<span id="cb361-6"><a href="bootstrap-paramétrico.html#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb361-7"><a href="bootstrap-paramétrico.html#cb361-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">try</span>(<span class="cf">if</span>(res_boot<span class="sc">$</span>convergence <span class="sc">!=</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;No se alcanzó convergencia.&quot;</span>))</span>
<span id="cb361-8"><a href="bootstrap-paramétrico.html#cb361-8" aria-hidden="true" tabindex="-1"></a>  est_mle_boot <span class="ot">&lt;-</span> res_boot<span class="sc">$</span>par </span>
<span id="cb361-9"><a href="bootstrap-paramétrico.html#cb361-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(est_mle_boot) <span class="ot">&lt;-</span> <span class="fu">names</span>(pars)</span>
<span id="cb361-10"><a href="bootstrap-paramétrico.html#cb361-10" aria-hidden="true" tabindex="-1"></a>  est_mle_boot[<span class="st">&quot;rep&quot;</span>] <span class="ot">&lt;-</span> rep</span>
<span id="cb361-11"><a href="bootstrap-paramétrico.html#cb361-11" aria-hidden="true" tabindex="-1"></a>  est_mle_boot[<span class="st">&quot;convergence&quot;</span>] <span class="ot">&lt;-</span> res_boot<span class="sc">$</span>convergence</span>
<span id="cb361-12"><a href="bootstrap-paramétrico.html#cb361-12" aria-hidden="true" tabindex="-1"></a>  est_mle_boot</span>
<span id="cb361-13"><a href="bootstrap-paramétrico.html#cb361-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb361-14"><a href="bootstrap-paramétrico.html#cb361-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8934</span>)</span>
<span id="cb361-15"><a href="bootstrap-paramétrico.html#cb361-15" aria-hidden="true" tabindex="-1"></a>reps_boot <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, <span class="sc">~</span> <span class="fu">rep_boot</span>(.x, simular_modelo, crear_log_p, est_mle, </span>
<span id="cb361-16"><a href="bootstrap-paramétrico.html#cb361-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> <span class="fu">length</span>(muestra))) <span class="sc">%&gt;%</span> </span>
<span id="cb361-17"><a href="bootstrap-paramétrico.html#cb361-17" aria-hidden="true" tabindex="-1"></a>  bind_rows</span>
<span id="cb361-18"><a href="bootstrap-paramétrico.html#cb361-18" aria-hidden="true" tabindex="-1"></a>reps_boot <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), round, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> head</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   p_azar_logit p_corr_logit   rep convergence
##          &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
## 1         0.32        -0.7      1           0
## 2         0.13        -0.71     2           0
## 3         0.11        -0.78     3           0
## 4        -0.19        -0.71     4           0
## 5         0.36        -0.55     5           0
## 6         0.74        -0.61     6           0</code></pre>
<p>El optimizador encontró resultados que no tienen sentido:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="bootstrap-paramétrico.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reps_boot, </span>
<span id="cb363-2"><a href="bootstrap-paramétrico.html#cb363-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">inv_logit</span>(p_azar_logit), <span class="at">y =</span> <span class="fu">inv_logit</span>(p_corr_logit), </span>
<span id="cb363-3"><a href="bootstrap-paramétrico.html#cb363-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="fu">factor</span>(convergence))) <span class="sc">+</span></span>
<span id="cb363-4"><a href="bootstrap-paramétrico.html#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb363-5"><a href="bootstrap-paramétrico.html#cb363-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;p_azar&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;p_corr&quot;</span>)</span></code></pre></div>
<p><img src="10-bootstrap-parametrico_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Y notamos un problema grave: Tenemos mucha variación en nuestros estimadores,
y la correlación entre las estimaciones es alta. Esto deberíamos haberlo esperado,
pues como las probabilidades de contestar correctamente son muy similares a las
de contestar al azar:</p>
<ul>
<li><strong>Existen muchas combinaciones de parámetros que son consistentes
con los datos</strong>. Decimos entonces que este modelo está mal identificado
con estos datos.</li>
<li>La mala identificación, como vemos, es una propiedad tanto de modelo como
datos.</li>
</ul>
<div class="ejercicio">
<ul>
<li>
¿Qué conclusiones acerca del examen obtienes al ver estas
simulaciones bootstrap? ¿Cómo se deberían reportar estos
resultados?
</li>
<li>
Qué pasa en este ejemplo si la <span class="math inline"><span class="math inline">\(p_{corr}\)</span></span> es más grande, o el tamaño de
muestra es más grande?
</li>
<li>
Repite el ejercicio con los parámetros del primer ejemplo (<span class="math inline"><span class="math inline">\(p_{azar} = 0.3, p_{corr}=0.75\)</span></span>) y el mismo
tamaño de muestra. ¿Qué sucede en este caso?
</li>
<li>
En el caso extremo, decimos que el modelo no está indentificado, y
eso generalmente sucede por un problema en el planteamiento del modelo,
independientemente de los datos. ¿Puedes imaginar un modelo así?
</li>
</ul>
</div>

</div>
</div>
<script type="text/javascript">smartify();</script>
            </section>

          </div>
        </div>
      </div>
<a href="estimación-por-máxima-verosimilitud.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="apéndice-principios-de-visualizacion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/10-bootstrap-parametrico.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fundamentos-estadistica.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
